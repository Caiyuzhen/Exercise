/* 
	æœåŠ¡å™¨è®¿é—®çš„å®‰å…¨æ€§
	
		å¯†é’¥
			å…¬é’¥ => å…¶ä»–äººå¯æ‹¥æœ‰
			ç§é’¥ => è‡ªå·±æ‹¥æœ‰
		ç­¾å
			å¦‚ä½•ç”Ÿæˆç­¾å
				1.é€‰æ‹©åŠ å¯†ç®—æ³•, æ¯”å¦‚ SHA-256ã€HMACã€REA ç­‰ã€‚
				2.å°†å¾…ç­¾åçš„æ•°æ®ï¼ˆå…¥æ–‡æœ¬ã€æ–‡ä»¶ã€è¯·æ±‚å‚æ•°ç­‰ï¼‰å’Œå¯†é’¥è¿›è¡Œè¾“å…¥, ä½¿ç”¨åŠ å¯†ç®—æ³•å¾—åˆ°åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼ˆå³ç­¾åï¼‰ã€‚
				3.å°†ç”Ÿæˆåçš„ç­¾åé™„åŠ åˆ°åŸå§‹æ•°æ®ä¸Š, ä¸€èµ·é™„å¸¦å‘é€ç»™æ¥æ”¶æ–¹ã€‚

			å¦‚ä½•éªŒè¯ç­¾å:
				1.æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®å’Œç­¾åå, ä½¿ç”¨ç›¸åŒçš„ç®—æ³•å’Œå¯†é’¥ï¼ˆä¾‹å¦‚ã€ğŸ”¥å…¬é’¥ã€‘æˆ–å…±äº«å¯†é’¥ï¼‰å¯¹åŸå§‹æ•°æ®è¿›è¡Œè®¡ç®—, å¾—åˆ°ä¸€ä¸ªæ–°çš„ç­¾åã€‚ => æ³¨æ„, æ¥æ”¶æ–¹æ˜¯ç”¨å…¬é’¥è·ŸåŠ å¯†ç®—æ³•æ¥ç”Ÿæˆæ–°çš„ç­¾å
				2.æ¯”è¾ƒæ–°çš„ç­¾åå’Œæ¥æ”¶åˆ°çš„ç­¾åæ˜¯å¦ç›¸åŒ, å¦‚æœç›¸åŒ, åˆ™è¯´æ˜æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹, å¦‚æœä¸åŒ, åˆ™è¯´æ˜æ•°æ®è¢«ç¯¡æ”¹è¿‡æˆ–è€…ä¼ªé€ ã€‚


		å…¬é’¥ç»“åˆç§é’¥ => éå¯¹ç§°åŠ å¯† ğŸ”
			ç§é’¥ + è¦ä¼ è¾“çš„æ•°æ® + ç‰¹å®šç®—æ³• = å¾—å‡ºåŠ å¯†çš„å­—ç¬¦ä¸²ï¼ˆç­¾åï¼‰
			å…¬é’¥ + æ¥æ”¶åˆ°çš„æ•°æ® + ç›¸åŒç®—æ³• = å¾—å‡ºåŠ å¯†çš„å­—ç¬¦ä¸²ï¼ˆç­¾åï¼‰
		
*/

const jwt = require('jsonwebtoken'); // npm install jsonwebtoken
const fs = require('fs');


// ç”Ÿæˆ RSA å¯†é’¥å¯¹
const { privateKey, publicKey } =  // äº§ç”Ÿ privateKey ç§é’¥ è·Ÿ publicKey å…¬é’¥
crypto.generateKeyRairSync('rsa', {
	modulesLength: 2048,
});

// åˆ›å»º JWT
const payloda = { user: 'john.doe' };
const token = jwt.sign(payload, privateKey, {
	algorithm: 'RS256',
});

console.log('JWT å¯†é’¥:', token);

// éªŒè¯ JWT
jwt.verify(token, publicKey, { algorithms: ['RS256'] }, (err, decoded) => {
	if(err) {
		console.log('éªŒè¯å¤±è´¥');
	} else {
		console.log('éªŒè¯æˆåŠŸ', decoded);
	}
});