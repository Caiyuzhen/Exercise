<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§†çª—è§¦å‘äº‹ä»¶</title>
</head>
<body>
    <h1 class="h1">è§†çª—è§¦å‘äº‹ä»¶</h1>
    <h2>å•¦å•¦å•¦</h2>
    <div class="box">æˆ‘æ˜¯è¢«è§‚å¯Ÿå¯¹è±¡</div>
    <p>æˆ‘æ˜¯ä¸€æ®µå†…å®¹æˆ‘æ˜¯ä¸€æ®µå†…å®¹æˆ‘æ˜¯ä¸€æ®µå†…å®¹æˆ‘æ˜¯ä¸€æ®µå†…å®¹æˆ‘æ˜¯ä¸€æ®µå†…å®¹æˆ‘æ˜¯ä¸€æ®µå†…å®¹</p>
    <!-- 
        ä¼ ç»Ÿçš„æ–¹æ³•ï¼š
            Element.getElientBoundRect    è®¡ç®—å…ƒç´ ä¸æµè§ˆå™¨[æ˜¾ç¤ºçª—å£]é¡¶éƒ¨çš„è·ç¦»çš„å·®å€¼,çœ‹æ˜¯å¦ < å…ƒç´ æœ¬èº«çš„é«˜åº¦


        ç°åœ¨çš„æ–¹æ³•ï¼š
            Why?
                å¯¹æ€§èƒ½æŸè€—æ¯”è¾ƒå°

            Whatï¼Ÿ
                 IntersectionObserver  äº¤å‰è§‚å¯Ÿå™¨(æœ¬è´¨æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°)
                ã€è¢«è§‚å¯Ÿå…ƒç´ ã€‘ä¸ã€è§†çª—ã€‘æˆ–è€…ã€çˆ¶çº§å…ƒç´ ã€‘çš„ã€ç›¸äº¤åŒºåŸŸã€‘
                 ğŸŒŸ é»˜è®¤ã€è¿›å…¥ã€‘è¾¾åˆ°ç›¸äº¤æ¯”ä¾‹å°±ä¼šè§¦å‘ï¼Œã€ç§»å‡ºã€‘æ—¶è¾¾åˆ°ç›¸äº¤æ¯”ä¾‹ä¹Ÿä¼šè§¦å‘
                 è§‚å¯Ÿå™¨çš„å›è°ƒå‡½æ•°éƒ½æ˜¯å¼‚æ­¥çš„ï¼ˆä¼šæœ‰å°å»¶è¿Ÿï¼‰
                
            How?
                å¯ä»¥å®šä¹‰ä¸€ä¸ªç›‘å¬å™¨ï¼Œç›‘å¬ ã€root: XXX è¿™é‡Œå®šä¹‰çš„å¯¹è±¡ã€‘ä¸ã€è¢«è§‚å¯Ÿå…ƒç´ ã€‘çš„ã€ç›¸äº¤åŒºåŸŸã€‘
                å¯ä»¥è®¾ç½®ç›¸äº¤çš„æ¯”ä¾‹, æ¯”å¦‚ç›¸äº¤çš„æ¯”ä¾‹æ˜¯ 0.5, å°±æ˜¯è¶…è¿‡å…ƒç´ çš„ä¸€åŠ

            åº”ç”¨åœºæ™¯
                ä¸€ã€å›¾ç‰‡æ‡’åŠ è½½ï¼ˆæ»šåŠ¨åˆ°å¯¹åº”çš„ä½ç½®ï¼Œå°±åŠ è½½å›¾ç‰‡,å†…å®¹æ— é™æ»šåŠ¨çš„æ•ˆæœï¼‰
                        é€šè¿‡ src å±æ€§ï¼Œæ»šåŠ¨åˆ°å¯¹åº”çš„ä½ç½®å†åŠ ä¸Šå›¾ç‰‡çš„ src åœ°å€ï¼Œå°±å¯ä»¥å®ç°æ‡’åŠ è½½
                äºŒã€æ£€æµ‹å¹¿å‘Šä½çš„æ›å…‰æƒ…å†µ    
                        æ¯”å¦‚æœ‰æ²¡æœ‰å‡ºç°åœ¨æµè§ˆå™¨è§†çª—å†…
                ä¸‰ã€çœ‹è§æŸä¸ªåŒºåŸŸæ—¶å°±æ‰§è¡Œä¸€äº›å…¥åœºåŠ¨ç”»
                        æ¯”å¦‚å¤©æ°”æ¡ˆä¾‹
     -->
    
</body>


<style>
    html{
        overflow-x: hidden;

    }
    body{
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .box {
        width: 200px;
        height: 200px;
        background-color: #000000;
        transition: transform, width .3s ease-in-out;
        transform: translateY(1200px);
        text-align: center;
        /* è®©æ–‡å­—å‚ç›´å±…ä¸­ */
        display: flex;
        justify-content: center;
        align-items: center;
    }
    p{
        transform: translateY(1400px);
    }

    /* js åŠ¨æ€æ·»åŠ çš„ç±»å */
    .abc{
        background-color: #532dd1;
        font-size: 32px;
        text-align: center;
        /* è®©æ–‡å­—å‚ç›´å±…ä¸­ */
        display: flex;
        justify-content: center;
        align-items: center;
        color: #fff;
        width: 400px;
        height: 400px;
        transition: transform, width font-size .3s ease-in-out;
    }
    
</style>



<script type="text/javascript">

    const box = document.querySelector('.box');



// ğŸ‘‡ åˆ›å»ºäº¤å‰è§‚å¯Ÿå™¨
    function callback(entries){ //ä¸€èˆ¬å°±å®šä¹‰ä¸º entries ï¼Œå¦‚æœè¦ä½¿ç”¨ç€å‚æ•°çš„è¯ï¼Œé‚£éœ€è¦å®šä¹‰å¥½è¿™ä¸ª è¡Œå‚ çš„ä½ç½®ï¼Œå› ä¸ºå›è°ƒå‡½æ•°å›è‡ªåŠ¨ä¼ å…¥è¿™ä¸ªå®å‚
        console.log('è¿›å…¥è§†çª—äº†')
        // console.log(entries)//ä¼šè¿”å›å›è°ƒå‡½æ•° IntersectionObserverEntry æ•°ç»„å¯¹è±¡

        entries.forEach(item => {

            console.log((item.intersectionRatio).toFixed(2)) //ä¼šè¿”å›ç›¸äº¤åŒºåŸŸçš„æ¯”ä¾‹
            if(item.intersectionRatio >= 1){ // ğŸŒŸğŸŒŸåˆ¤æ–­ä¸€ä¸‹ï¼Œç›¸äº¤æ¯”ä¾‹æ˜¯å¦å¤§äºç­‰äº 1 ï¼Œæ»¡è¶³æ¡ä»¶é‡‡å–æ”¹å˜å…ƒç´ çš„é¢œè‰²è·Ÿå°ºå¯¸
                
                item.target.classList.add("abc") //ğŸŒŸğŸŒŸ target å°±æ˜¯é‚£ä¸ªå…ƒç´ äº†ï¼Œå°±ä¸€å°±èƒ½æ·»åŠ ä¸€äº›æ ·å¼çš„å˜åŒ–äº†ï¼ï¼

                // ğŸŒŸğŸŒŸğŸŒŸ item é‡Œè¾¹åŒ…å«çš„æ•°æ®
                    //é‡è¦
                        //intersectionRatio     ç›®æ ‡å…ƒç´ ä¸äº¤å‰åŒºåŸŸçš„å¯è§æ¯”ä¾‹ï¼ˆå³ intersectionRect å  boundingClientRect çš„æ¯”ä¾‹ã€è·Ÿè€æ–¹æ³•å»åŠ¨æ€è®¡ç®—æ˜¯ä¸€ä¸ªæ„æ€ã€‘ï¼‰ï¼Œå®Œå…¨å¯è§æ—¶ä¸º 1ï¼Œå®Œå…¨ä¸å¯è§æ—¶ <= 0pxï¼‰ï¼ˆå¼‚æ­¥æ‰§è¡Œï¼Œæ²¡é‚£ä¹ˆå‡†ï¼‰ ã€ intersectionRatio = intersectionRect / boundingClientRectã€‘
                        //target                è§¦å‘å›è°ƒå‡½æ•°çš„é‚£ä¸ªå…ƒç´ ï¼ˆæ¯”å¦‚ h1ã€divï¼‰ï¼Œæ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹å¯¹è±¡
                        //intersecting          false å¾€åˆ†ç¦»æ–¹å‘   true å¾€ç›¸äº¤ï¼ˆè¿”å›çš„æ—¶å€™ï¼‰æ–¹å‘
       
                    //äº†è§£
                        //time                  å¯è§æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ï¼Œæ˜¯ä¸€ä¸ªé«˜ç²¾åº¦çš„æ—¶é—´æˆ³ï¼Œç²¾åº¦ä¸ºæ¯«ç§’
                        //rootBounds            æ ¹å…ƒç´ çš„çŸ©å½¢åŒºåŸŸï¼ˆç›’æ¨¡å‹ï¼‰çš„ä¿¡æ¯ï¼Œ getBoundingClientRect() æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æ ¹å…ƒç´ ï¼ˆå³ç›´æ¥ç›¸å¯¹äºè§†å£æ»šåŠ¨ï¼‰
                        //intersectionRect      è¢«ç›¸äº¤çš„ã€ç›®æ ‡å…ƒç´ ã€‘çš„çŸ©å½¢åŒºåŸŸï¼ˆç›’æ¨¡å‹ï¼‰çš„ä¿¡æ¯
                        //boundingClientRect    è¢«ç›¸äº¤çš„ã€ç›®æ ‡å…ƒç´ ã€‘ä¸ã€äº¤å‰åŒºåŸŸã€‘çš„ä¿¡æ¯     

            } else if (item.intersectionRatio < 0.5){

                item.target.classList.remove("abc") //ç§»å‡ºè§‚å¯Ÿå™¨åŒºåŸŸçš„è¯å°±ç§»é™¤è¿™ä¸ªæ•ˆæœ

            }         
        })
    }


    const options = {
        // root:null, //éœ€è¦è¢«ç›¸äº¤çš„å…ƒç´ ï¼Œæ¯”å¦‚å…ƒç´ çš„çˆ¶çº§ï¼ˆæˆ–å‚ç…§ç›®æ ‡ï¼‰ï¼Œé»˜è®¤è®¾ç½®çš„è¯å°±æ˜¯ä»¥ã€è§†çª—ã€‘ä¸ºç›¸äº¤ç›®æ ‡
        rootMargin:'5px 2% 0px 0px', //è¿™ä¸ªä¸€å®šè¦å¸¦å•ä½! å¯ä»¥æ”¹å˜ç›¸äº¤åŒºåŸŸçš„ä½ç½®(ç›¸å½“äºç»™å®ƒåŠ ä¸Šã€å³ã€ä¸‹ã€å·¦çš„ marginï¼‰ï¼Œä¸€å®šè¦å¸¦å•ä½, å¦‚æœç›¸äº¤ç›®æ ‡æ˜¯æµè§ˆå™¨çª—å£çš„ä¸ºå‚ç…§çš„è¯ï¼Œä¸€å®šè¦å¸¦ç™¾åˆ†æ¯”(ğŸŒŸ-50%å°±æ˜¯çª—å£çš„ä¸€åŠ!)ã€‚ï¼ˆ + æ­£å€¼å‘å¤–å»¶ä¼¸ï¼Œ - è´Ÿå€¼å‘å†…ç¼©å°ï¼‰
        threshold: [0, 0.5, 1] //ç›¸äº¤çš„æ¯”ä¾‹ï¼ˆ0ï½1ï¼‰çš„èŒƒå›´ï¼Œè¿˜å¯ä»¥ä¼ æ•°ç»„ï¼Œè®¾ç½®å¤šä¸ªæ¯”ä¾‹ï¼Œæ¯”å¦‚[0.2, 0.4, 0.6],æ¯è¾¾åˆ°æŸä¸ªæ¯”ä¾‹çš„è¯éƒ½ä¼šè§¦å‘
        // threshold: 1 // 1 å°±æ˜¯ç›¸äº¤æ¯”ä¾‹ä¸º 100% ç›¸äº¤æ—¶ä¼šè§¦å‘ä¸€æ¬¡
    }

    const element = new IntersectionObserver(callback,options) //åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹,ğŸŒŸğŸŒŸé¡ºåºè¦æ”¾åœ¨ä¸‹é¢!!



//ğŸ‘‡è°ƒç”¨è§‚å¯Ÿå™¨
    element.observe(box) //è°ƒç”¨ observer çš„å®ä¾‹ï¼ˆğŸŒŸğŸŒŸä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹å¯ä»¥ç»‘å®šå¤šä¸ªå…ƒç´ ), æœ¬è´¨ä¸Šæ˜¯å»è°ƒç”¨ observer çš„æ–¹æ³•

//ğŸ‘‡ åœæ­¢è§‚å¯Ÿ
    // element.unobserve

//ğŸ‘‡ å…³é—­è§‚å¯Ÿå™¨
    // element.disconnect()


</script>


</html>
